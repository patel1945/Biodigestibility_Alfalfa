216/8
# stagewise
rm(list = ls())
library(StageWise)
library(asreml)
library(data.table)
library(tidyverse)
library(asremlPlus)
library(ggplot2)
library(ggrepel)
library(goeveg)
library(ggpubr)
load("/Users/cesarmedina/Documents/git/big_files/tidy_Dreger1.RData")
install.packages("visreg")
library(visreg)
visreg(ST5[[1]], "FD", by = "loc")
visreg(ST5[[1]], "FD")
visreg(ST5[[3]], "FD")
class(ST5[[3]])
visreg(ST5[[3]], "loc", gg=TRUE, ylab="predicted.value")
#load car package
library(car)
#produce added variable plots
avPlots(ST5[[3]])
ggPredict(ST5[[3]],digits=1, show.error = TRUE, facet.modx = TRUE, show.text=FALSE)
require(predict3d)
require(rgl)
install.packages("predict3d")
require(predict3d)
require(rgl)
ggPredict(ST5[[3]],digits=1, show.error = TRUE, facet.modx = TRUE, show.text=FALSE)
if(!require(devtools)) install.packages("devtools")
devtools::install_github("cardiomoon/predict3d")
require(predict3d)
require(rgl)
install.packages("rgl")
install.packages("rgl")
require(rgl)
require(predict3d)
ggPredict(ST5[[3]],digits=1, show.error = TRUE, facet.modx = TRUE, show.text=FALSE)
ggPredict(ST5[[3]], show.point = FALSE,se=TRUE)
ggPredict(ST5[[3]], show.point = FALSE,se=TRUE,xpos=0.5,facet.modx = TRUE, facetbycol = FALSE)
ggPredict(ST5[[3]], show.point = FALSE,se=TRUE,xpos=0.5, facet.modx = F, facetbycol = FALSE)
plot2 <- ggPredict(ST5[[3]], show.point = FALSE,se=TRUE,xpos=0.5, facet.modx = F, facetbycol = FALSE)
class(plot2)
View(plot2)
?ggPredict
ggPredict(ST5[[3]], facet.modx = TRUE,add.modx.values = FALSE,xpos=0.5, show.point = FALSE)
ggPredict(ST5[[3]], facet.modx = F,add.modx.values = FALSE,xpos=0.5, show.point = FALSE)
ggPredict(ST5[[3]], pred=FD, modx=loc, show.point = FALSE,se=TRUE,xpos=0.5)
ggPredict(ST5[[3]], show.point = FALSE,se=TRUE)
ggPredict(ST5[[3]], show.point = FALSE,se=TRUE,xpos=0.5, facet.modx = F, facetbycol = FALSE)
names(ST3)
data1 <- ST3[[3]]
lm1 <- lm(predicted.value ~ FD + year + loc +
FD:year + FD:loc +
FD:year:loc)
lm1 <- lm(predicted.value ~ FD + year + loc +
FD:year + FD:loc +
FD:year:loc, data = data1)
ggPredict(lm1,digits=1, show.error = TRUE, facet.modx = TRUE, show.text=FALSE)
ggPredict(ST5[[3]], show.point = FALSE,se=TRUE)
ggPredict(ST5[[3]], show.point = FALSE,se=TRUE,xpos=0.5, facet.modx = F, facetbycol = FALSE)
lm1 <- lm(predicted.value ~ FD + year + loc +
FD:year + FD:loc, data = data1)
ggPredict(lm1, show.point = FALSE,se=TRUE,xpos=0.5, facet.modx = F, facetbycol = FALSE)
lm1 <- lm(predicted.value ~ FD + year + loc +
FD:year + FD:loc, data = data1)
ggPredict(lm1, show.point = FALSE,se=TRUE,xpos=0.5, facet.modx = F, facetbycol = FALSE)
plot1 <- plot_model(ST5[[3]], type = "eff", terms = c("FD", "loc"))
library(sjPlot)
plot1 <- plot_model(ST5[[3]], type = "eff", terms = c("FD", "loc"))
plot1
plot1 <- plot_model(ST5[[3]], type = "eff", terms = c("FD"))
plot1
names(ST5)
ST5
names(ST5)
plot1 <- plot_model(ST5[[3]], type = "eff", terms = c("FD","year"))
plot1
plot1 <- plot_model(ST5[[3]], type = "eff", terms = c("FD","loc"))
plot1
library(asreml)
install.packages(c("afex", "AGHmatrix", "ape", "asremlPlus", "ASRgenomics", "bayestestR", "BH", "bibtex", "BiocManager", "bit", "blob", "boot", "broom", "bs4Dash", "cachem", "car", "caret", "checkmate", "chron", "class", "classInt", "cli", "clock", "CMplot", "codetools", "commonmark", "confintr", "conquer", "correlation", "curl", "dae", "datawizard", "dbplyr", "deldir", "dendextend", "DescTools", "deSolve", "distributional", "doFuture", "doRNG", "dplyr", "DT", "dtplyr", "e1071", "effectsize", "ellipse", "emmeans", "evaluate", "expm", "extrafont", "FactoMineR", "fastmatrix", "fBasics", "flextable", "fontawesome", "forcats", "foreign", "formatR", "Formula", "fs", "future", "future.apply", "gargle", "gdata", "gdtools", "gert", "ggeffects", "ggfortify", "ggiraph", "ggplot2", "ggpp", "ggpubr", "ggrepel", "ggsci", "ggside", "ggstatsplot", "gh", "globals", "gmp", "goeveg", "golem", "googledrive", "googlesheets4", "gower", "GROAN", "gss", "gtable", "gtools", "hardhat", "haven", "heatmaply", "Hmisc", "hms", "htmltools", "htmlwidgets", "httpuv", "httr", "igraph", "insight", "interp", "inti", "ipred", "jpeg", "KernSmooth", "klaR", "knitr", "labelled", "later", "lattice", "lava", "listenv", "lme4", "locfit", "loo", "lpSolve", "lubridate", "magick", "mappoly", "maptools", "markdown", "MASS", "Matrix", "matrixStats", "mc2d", "memuse", "metan", "mgcv", "modelr", "monomvn", "multcomp", "multcompView", "ncvreg", "nleqslv", "nlme", "nnet", "officer", "openssl", "ordinal", "packrat", "parallelly", "parameters", "pbapply", "pbkrtest", "performance", "pillar", "pkgbuild", "pkgdown", "pkgload", "plot3Drgl", "pls", "png", "polymapR", "posterior", "predict3d", "pROC", "processx", "prodlim", "profvis", "progressr", "pryr", "ps", "psych", "QBMS", "quantreg", "questionr", "ragg", "ranger", "rbibutils", "rcompanion", "RcppArmadillo", "RcppParallel", "RcppTOML", "RCurl", "readr", "readxl", "recipes", "reticulate", "rgl", "rlang", "rmarkdown", "Rmpfr", "roxygen2", "rrBLUP", "rsconnect", "RSQLite", "rstan", "rstantools", "rstatix", "Rttf2pt1", "rvg", "sass", "scam", "scattermore", "scatterplot3d", "seriation", "shiny", "shinyWidgets", "sjPlot", "sommer", "sourcetools", "sp", "spatial", "StanHeaders", "statsExpressions", "styler", "svglite", "sys", "testthat", "TH.data", "tibble", "tidyverse", "timechange", "timeDate", "timeSeries", "tinytex", "truncnorm", "TSP", "tzdb", "ucminf", "vcfR", "vctrs", "viridis", "viridisLite", "vroom", "waldo", "WGCNA", "whisker", "xfun", "XML", "xml2", "xts", "zip", "zoo"))
install.packages(c("afex", "AGHmatrix", "ape", "asremlPlus", "ASRgenomics", "bayestestR", "BH", "bibtex", "BiocManager", "bit", "blob", "boot", "broom", "bs4Dash", "cachem", "car", "caret", "checkmate", "chron", "class", "classInt", "cli", "clock", "CMplot", "codetools", "commonmark", "confintr", "conquer", "correlation", "curl", "dae", "datawizard", "dbplyr", "deldir", "dendextend", "DescTools", "deSolve", "distributional", "doFuture", "doRNG", "dplyr", "DT", "dtplyr", "e1071", "effectsize", "ellipse", "emmeans", "evaluate", "expm", "extrafont", "FactoMineR", "fastmatrix", "fBasics", "flextable", "fontawesome", "forcats", "foreign", "formatR", "Formula", "fs", "future", "future.apply", "gargle", "gdata", "gdtools", "gert", "ggeffects", "ggfortify", "ggiraph", "ggplot2", "ggpp", "ggpubr", "ggrepel", "ggsci", "ggside", "ggstatsplot", "gh", "globals", "gmp", "goeveg", "golem", "googledrive", "googlesheets4", "gower", "GROAN", "gss", "gtable", "gtools", "hardhat", "haven", "heatmaply", "Hmisc", "hms", "htmltools", "htmlwidgets", "httpuv", "httr", "igraph", "insight", "interp", "inti", "ipred", "jpeg", "KernSmooth", "klaR", "knitr", "labelled", "later", "lattice", "lava", "listenv", "lme4", "locfit", "loo", "lpSolve", "lubridate", "magick", "mappoly", "maptools", "markdown", "MASS", "Matrix", "matrixStats", "mc2d", "memuse", "metan", "mgcv", "modelr", "monomvn", "multcomp", "multcompView", "ncvreg", "nleqslv", "nlme", "nnet", "officer", "openssl", "ordinal", "packrat", "parallelly", "parameters", "pbapply", "pbkrtest", "performance", "pillar", "pkgbuild", "pkgdown", "pkgload", "plot3Drgl", "pls", "png", "polymapR", "posterior", "predict3d", "pROC", "processx", "prodlim", "profvis", "progressr", "pryr", "ps", "psych", "QBMS", "quantreg", "questionr", "ragg", "ranger", "rbibutils", "rcompanion", "RcppArmadillo", "RcppParallel", "RcppTOML", "RCurl", "readr", "readxl", "recipes", "reticulate", "rgl", "rlang", "rmarkdown", "Rmpfr", "roxygen2", "rrBLUP", "rsconnect", "RSQLite", "rstan", "rstantools", "rstatix", "Rttf2pt1", "rvg", "sass", "scam", "scattermore", "scatterplot3d", "seriation", "shiny", "shinyWidgets", "sjPlot", "sommer", "sourcetools", "sp", "spatial", "StanHeaders", "statsExpressions", "styler", "svglite", "sys", "testthat", "TH.data", "tibble", "tidyverse", "timechange", "timeDate", "timeSeries", "tinytex", "truncnorm", "TSP", "tzdb", "ucminf", "vcfR", "vctrs", "viridis", "viridisLite", "vroom", "waldo", "WGCNA", "whisker", "xfun", "XML", "xml2", "xts", "zip", "zoo"))
install.packages(c("afex", "AGHmatrix", "ape", "asremlPlus", "ASRgenomics", "bayestestR", "BH", "bibtex", "BiocManager", "bit", "blob", "boot", "broom", "bs4Dash", "cachem", "car", "caret", "checkmate", "chron", "class", "classInt", "cli", "clock", "CMplot", "codetools", "commonmark", "confintr", "conquer", "correlation", "curl", "dae", "datawizard", "dbplyr", "deldir", "dendextend", "DescTools", "deSolve", "distributional", "doFuture", "doRNG", "dplyr", "DT", "dtplyr", "e1071", "effectsize", "ellipse", "emmeans", "evaluate", "expm", "extrafont", "FactoMineR", "fastmatrix", "fBasics", "flextable", "fontawesome", "forcats", "foreign", "formatR", "Formula", "fs", "future", "future.apply", "gargle", "gdata", "gdtools", "gert", "ggeffects", "ggfortify", "ggiraph", "ggplot2", "ggpp", "ggpubr", "ggrepel", "ggsci", "ggside", "ggstatsplot", "gh", "globals", "gmp", "goeveg", "golem", "googledrive", "googlesheets4", "gower", "GROAN", "gss", "gtable", "gtools", "hardhat", "haven", "heatmaply", "Hmisc", "hms", "htmltools", "htmlwidgets", "httpuv", "httr", "igraph", "insight", "interp", "inti", "ipred", "jpeg", "KernSmooth", "klaR", "knitr", "labelled", "later", "lattice", "lava", "listenv", "lme4", "locfit", "loo", "lpSolve", "lubridate", "magick", "mappoly", "maptools", "markdown", "MASS", "Matrix", "matrixStats", "mc2d", "memuse", "metan", "mgcv", "modelr", "monomvn", "multcomp", "multcompView", "ncvreg", "nleqslv", "nlme", "nnet", "officer", "openssl", "ordinal", "packrat", "parallelly", "parameters", "pbapply", "pbkrtest", "performance", "pillar", "pkgbuild", "pkgdown", "pkgload", "plot3Drgl", "pls", "png", "polymapR", "posterior", "predict3d", "pROC", "processx", "prodlim", "profvis", "progressr", "pryr", "ps", "psych", "QBMS", "quantreg", "questionr", "ragg", "ranger", "rbibutils", "rcompanion", "RcppArmadillo", "RcppParallel", "RcppTOML", "RCurl", "readr", "readxl", "recipes", "reticulate", "rgl", "rlang", "rmarkdown", "Rmpfr", "roxygen2", "rrBLUP", "rsconnect", "RSQLite", "rstan", "rstantools", "rstatix", "Rttf2pt1", "rvg", "sass", "scam", "scattermore", "scatterplot3d", "seriation", "shiny", "shinyWidgets", "sjPlot", "sommer", "sourcetools", "sp", "spatial", "StanHeaders", "statsExpressions", "styler", "svglite", "sys", "testthat", "TH.data", "tibble", "tidyverse", "timechange", "timeDate", "timeSeries", "tinytex", "truncnorm", "TSP", "tzdb", "ucminf", "vcfR", "vctrs", "viridis", "viridisLite", "vroom", "waldo", "WGCNA", "whisker", "xfun", "XML", "xml2", "xts", "zip", "zoo"))
install.packages(c("afex", "AGHmatrix", "ape", "asremlPlus", "ASRgenomics", "bayestestR", "BH", "bibtex", "BiocManager", "bit", "blob", "boot", "broom", "bs4Dash", "cachem", "car", "caret", "checkmate", "chron", "class", "classInt", "cli", "clock", "CMplot", "codetools", "commonmark", "confintr", "conquer", "correlation", "curl", "dae", "datawizard", "dbplyr", "deldir", "dendextend", "DescTools", "deSolve", "distributional", "doFuture", "doRNG", "dplyr", "DT", "dtplyr", "e1071", "effectsize", "ellipse", "emmeans", "evaluate", "expm", "extrafont", "FactoMineR", "fastmatrix", "fBasics", "flextable", "fontawesome", "forcats", "foreign", "formatR", "Formula", "fs", "future", "future.apply", "gargle", "gdata", "gdtools", "gert", "ggeffects", "ggfortify", "ggiraph", "ggplot2", "ggpp", "ggpubr", "ggrepel", "ggsci", "ggside", "ggstatsplot", "gh", "globals", "gmp", "goeveg", "golem", "googledrive", "googlesheets4", "gower", "GROAN", "gss", "gtable", "gtools", "hardhat", "haven", "heatmaply", "Hmisc", "hms", "htmltools", "htmlwidgets", "httpuv", "httr", "igraph", "insight", "interp", "inti", "ipred", "jpeg", "KernSmooth", "klaR", "knitr", "labelled", "later", "lattice", "lava", "listenv", "lme4", "locfit", "loo", "lpSolve", "lubridate", "magick", "mappoly", "maptools", "markdown", "MASS", "Matrix", "matrixStats", "mc2d", "memuse", "metan", "mgcv", "modelr", "monomvn", "multcomp", "multcompView", "ncvreg", "nleqslv", "nlme", "nnet", "officer", "openssl", "ordinal", "packrat", "parallelly", "parameters", "pbapply", "pbkrtest", "performance", "pillar", "pkgbuild", "pkgdown", "pkgload", "plot3Drgl", "pls", "png", "polymapR", "posterior", "predict3d", "pROC", "processx", "prodlim", "profvis", "progressr", "pryr", "ps", "psych", "QBMS", "quantreg", "questionr", "ragg", "ranger", "rbibutils", "rcompanion", "RcppArmadillo", "RcppParallel", "RcppTOML", "RCurl", "readr", "readxl", "recipes", "reticulate", "rgl", "rlang", "rmarkdown", "Rmpfr", "roxygen2", "rrBLUP", "rsconnect", "RSQLite", "rstan", "rstantools", "rstatix", "Rttf2pt1", "rvg", "sass", "scam", "scattermore", "scatterplot3d", "seriation", "shiny", "shinyWidgets", "sjPlot", "sommer", "sourcetools", "sp", "spatial", "StanHeaders", "statsExpressions", "styler", "svglite", "sys", "testthat", "TH.data", "tibble", "tidyverse", "timechange", "timeDate", "timeSeries", "tinytex", "truncnorm", "TSP", "tzdb", "ucminf", "vcfR", "vctrs", "viridis", "viridisLite", "vroom", "waldo", "WGCNA", "whisker", "xfun", "XML", "xml2", "xts", "zip", "zoo"))
install.packages(c("afex", "AGHmatrix", "ape", "asremlPlus", "ASRgenomics", "bayestestR", "BH", "bibtex", "BiocManager", "bit", "blob", "boot", "broom", "bs4Dash", "cachem", "car", "caret", "checkmate", "chron", "class", "classInt", "cli", "clock", "CMplot", "codetools", "commonmark", "confintr", "conquer", "correlation", "curl", "dae", "datawizard", "dbplyr", "deldir", "dendextend", "DescTools", "deSolve", "distributional", "doFuture", "doRNG", "dplyr", "DT", "dtplyr", "e1071", "effectsize", "ellipse", "emmeans", "evaluate", "expm", "extrafont", "FactoMineR", "fastmatrix", "fBasics", "flextable", "fontawesome", "forcats", "foreign", "formatR", "Formula", "fs", "future", "future.apply", "gargle", "gdata", "gdtools", "gert", "ggeffects", "ggfortify", "ggiraph", "ggplot2", "ggpp", "ggpubr", "ggrepel", "ggsci", "ggside", "ggstatsplot", "gh", "globals", "gmp", "goeveg", "golem", "googledrive", "googlesheets4", "gower", "GROAN", "gss", "gtable", "gtools", "hardhat", "haven", "heatmaply", "Hmisc", "hms", "htmltools", "htmlwidgets", "httpuv", "httr", "igraph", "insight", "interp", "inti", "ipred", "jpeg", "KernSmooth", "klaR", "knitr", "labelled", "later", "lattice", "lava", "listenv", "lme4", "locfit", "loo", "lpSolve", "lubridate", "magick", "mappoly", "maptools", "markdown", "MASS", "Matrix", "matrixStats", "mc2d", "memuse", "metan", "mgcv", "modelr", "monomvn", "multcomp", "multcompView", "ncvreg", "nleqslv", "nlme", "nnet", "officer", "openssl", "ordinal", "packrat", "parallelly", "parameters", "pbapply", "pbkrtest", "performance", "pillar", "pkgbuild", "pkgdown", "pkgload", "plot3Drgl", "pls", "png", "polymapR", "posterior", "predict3d", "pROC", "processx", "prodlim", "profvis", "progressr", "pryr", "ps", "psych", "QBMS", "quantreg", "questionr", "ragg", "ranger", "rbibutils", "rcompanion", "RcppArmadillo", "RcppParallel", "RcppTOML", "RCurl", "readr", "readxl", "recipes", "reticulate", "rgl", "rlang", "rmarkdown", "Rmpfr", "roxygen2", "rrBLUP", "rsconnect", "RSQLite", "rstan", "rstantools", "rstatix", "Rttf2pt1", "rvg", "sass", "scam", "scattermore", "scatterplot3d", "seriation", "shiny", "shinyWidgets", "sjPlot", "sommer", "sourcetools", "sp", "spatial", "StanHeaders", "statsExpressions", "styler", "svglite", "sys", "testthat", "TH.data", "tibble", "tidyverse", "timechange", "timeDate", "timeSeries", "tinytex", "truncnorm", "TSP", "tzdb", "ucminf", "vcfR", "vctrs", "viridis", "viridisLite", "vroom", "waldo", "WGCNA", "whisker", "xfun", "XML", "xml2", "xts", "zip", "zoo"))
install.packages(c("afex", "AGHmatrix", "ape", "asremlPlus", "ASRgenomics", "bayestestR", "BH", "bibtex", "BiocManager", "bit", "blob", "boot", "broom", "bs4Dash", "cachem", "car", "caret", "checkmate", "chron", "class", "classInt", "cli", "clock", "CMplot", "codetools", "commonmark", "confintr", "conquer", "correlation", "curl", "dae", "datawizard", "dbplyr", "deldir", "dendextend", "DescTools", "deSolve", "distributional", "doFuture", "doRNG", "dplyr", "DT", "dtplyr", "e1071", "effectsize", "ellipse", "emmeans", "evaluate", "expm", "extrafont", "FactoMineR", "fastmatrix", "fBasics", "flextable", "fontawesome", "forcats", "foreign", "formatR", "Formula", "fs", "future", "future.apply", "gargle", "gdata", "gdtools", "gert", "ggeffects", "ggfortify", "ggiraph", "ggplot2", "ggpp", "ggpubr", "ggrepel", "ggsci", "ggside", "ggstatsplot", "gh", "globals", "gmp", "goeveg", "golem", "googledrive", "googlesheets4", "gower", "GROAN", "gss", "gtable", "gtools", "hardhat", "haven", "heatmaply", "Hmisc", "hms", "htmltools", "htmlwidgets", "httpuv", "httr", "igraph", "insight", "interp", "inti", "ipred", "jpeg", "KernSmooth", "klaR", "knitr", "labelled", "later", "lattice", "lava", "listenv", "lme4", "locfit", "loo", "lpSolve", "lubridate", "magick", "mappoly", "maptools", "markdown", "MASS", "Matrix", "matrixStats", "mc2d", "memuse", "metan", "mgcv", "modelr", "monomvn", "multcomp", "multcompView", "ncvreg", "nleqslv", "nlme", "nnet", "officer", "openssl", "ordinal", "packrat", "parallelly", "parameters", "pbapply", "pbkrtest", "performance", "pillar", "pkgbuild", "pkgdown", "pkgload", "plot3Drgl", "pls", "png", "polymapR", "posterior", "predict3d", "pROC", "processx", "prodlim", "profvis", "progressr", "pryr", "ps", "psych", "QBMS", "quantreg", "questionr", "ragg", "ranger", "rbibutils", "rcompanion", "RcppArmadillo", "RcppParallel", "RcppTOML", "RCurl", "readr", "readxl", "recipes", "reticulate", "rgl", "rlang", "rmarkdown", "Rmpfr", "roxygen2", "rrBLUP", "rsconnect", "RSQLite", "rstan", "rstantools", "rstatix", "Rttf2pt1", "rvg", "sass", "scam", "scattermore", "scatterplot3d", "seriation", "shiny", "shinyWidgets", "sjPlot", "sommer", "sourcetools", "sp", "spatial", "StanHeaders", "statsExpressions", "styler", "svglite", "sys", "testthat", "TH.data", "tibble", "tidyverse", "timechange", "timeDate", "timeSeries", "tinytex", "truncnorm", "TSP", "tzdb", "ucminf", "vcfR", "vctrs", "viridis", "viridisLite", "vroom", "waldo", "WGCNA", "whisker", "xfun", "XML", "xml2", "xts", "zip", "zoo"))
install.packages(c("afex", "AGHmatrix", "ape", "asremlPlus", "ASRgenomics", "bayestestR", "BH", "bibtex", "BiocManager", "bit", "blob", "boot", "broom", "bs4Dash", "cachem", "car", "caret", "checkmate", "chron", "class", "classInt", "cli", "clock", "CMplot", "codetools", "commonmark", "confintr", "conquer", "correlation", "curl", "dae", "datawizard", "dbplyr", "deldir", "dendextend", "DescTools", "deSolve", "distributional", "doFuture", "doRNG", "dplyr", "DT", "dtplyr", "e1071", "effectsize", "ellipse", "emmeans", "evaluate", "expm", "extrafont", "FactoMineR", "fastmatrix", "fBasics", "flextable", "fontawesome", "forcats", "foreign", "formatR", "Formula", "fs", "future", "future.apply", "gargle", "gdata", "gdtools", "gert", "ggeffects", "ggfortify", "ggiraph", "ggplot2", "ggpp", "ggpubr", "ggrepel", "ggsci", "ggside", "ggstatsplot", "gh", "globals", "gmp", "goeveg", "golem", "googledrive", "googlesheets4", "gower", "GROAN", "gss", "gtable", "gtools", "hardhat", "haven", "heatmaply", "Hmisc", "hms", "htmltools", "htmlwidgets", "httpuv", "httr", "igraph", "insight", "interp", "inti", "ipred", "jpeg", "KernSmooth", "klaR", "knitr", "labelled", "later", "lattice", "lava", "listenv", "lme4", "locfit", "loo", "lpSolve", "lubridate", "magick", "mappoly", "maptools", "markdown", "MASS", "Matrix", "matrixStats", "mc2d", "memuse", "metan", "mgcv", "modelr", "monomvn", "multcomp", "multcompView", "ncvreg", "nleqslv", "nlme", "nnet", "officer", "openssl", "ordinal", "packrat", "parallelly", "parameters", "pbapply", "pbkrtest", "performance", "pillar", "pkgbuild", "pkgdown", "pkgload", "plot3Drgl", "pls", "png", "polymapR", "posterior", "predict3d", "pROC", "processx", "prodlim", "profvis", "progressr", "pryr", "ps", "psych", "QBMS", "quantreg", "questionr", "ragg", "ranger", "rbibutils", "rcompanion", "RcppArmadillo", "RcppParallel", "RcppTOML", "RCurl", "readr", "readxl", "recipes", "reticulate", "rgl", "rlang", "rmarkdown", "Rmpfr", "roxygen2", "rrBLUP", "rsconnect", "RSQLite", "rstan", "rstantools", "rstatix", "Rttf2pt1", "rvg", "sass", "scam", "scattermore", "scatterplot3d", "seriation", "shiny", "shinyWidgets", "sjPlot", "sommer", "sourcetools", "sp", "spatial", "StanHeaders", "statsExpressions", "styler", "svglite", "sys", "testthat", "TH.data", "tibble", "tidyverse", "timechange", "timeDate", "timeSeries", "tinytex", "truncnorm", "TSP", "tzdb", "ucminf", "vcfR", "vctrs", "viridis", "viridisLite", "vroom", "waldo", "WGCNA", "whisker", "xfun", "XML", "xml2", "xts", "zip", "zoo"))
install.packages(c("afex", "AGHmatrix", "ape", "asremlPlus", "ASRgenomics", "bayestestR", "BH", "bibtex", "BiocManager", "bit", "blob", "boot", "broom", "bs4Dash", "cachem", "car", "caret", "checkmate", "chron", "class", "classInt", "cli", "clock", "CMplot", "codetools", "commonmark", "confintr", "conquer", "correlation", "curl", "dae", "datawizard", "dbplyr", "deldir", "dendextend", "DescTools", "deSolve", "distributional", "doFuture", "doRNG", "dplyr", "DT", "dtplyr", "e1071", "effectsize", "ellipse", "emmeans", "evaluate", "expm", "extrafont", "FactoMineR", "fastmatrix", "fBasics", "flextable", "fontawesome", "forcats", "foreign", "formatR", "Formula", "fs", "future", "future.apply", "gargle", "gdata", "gdtools", "gert", "ggeffects", "ggfortify", "ggiraph", "ggplot2", "ggpp", "ggpubr", "ggrepel", "ggsci", "ggside", "ggstatsplot", "gh", "globals", "gmp", "goeveg", "golem", "googledrive", "googlesheets4", "gower", "GROAN", "gss", "gtable", "gtools", "hardhat", "haven", "heatmaply", "Hmisc", "hms", "htmltools", "htmlwidgets", "httpuv", "httr", "igraph", "insight", "interp", "inti", "ipred", "jpeg", "KernSmooth", "klaR", "knitr", "labelled", "later", "lattice", "lava", "listenv", "lme4", "locfit", "loo", "lpSolve", "lubridate", "magick", "mappoly", "maptools", "markdown", "MASS", "Matrix", "matrixStats", "mc2d", "memuse", "metan", "mgcv", "modelr", "monomvn", "multcomp", "multcompView", "ncvreg", "nleqslv", "nlme", "nnet", "officer", "openssl", "ordinal", "packrat", "parallelly", "parameters", "pbapply", "pbkrtest", "performance", "pillar", "pkgbuild", "pkgdown", "pkgload", "plot3Drgl", "pls", "png", "polymapR", "posterior", "predict3d", "pROC", "processx", "prodlim", "profvis", "progressr", "pryr", "ps", "psych", "QBMS", "quantreg", "questionr", "ragg", "ranger", "rbibutils", "rcompanion", "RcppArmadillo", "RcppParallel", "RcppTOML", "RCurl", "readr", "readxl", "recipes", "reticulate", "rgl", "rlang", "rmarkdown", "Rmpfr", "roxygen2", "rrBLUP", "rsconnect", "RSQLite", "rstan", "rstantools", "rstatix", "Rttf2pt1", "rvg", "sass", "scam", "scattermore", "scatterplot3d", "seriation", "shiny", "shinyWidgets", "sjPlot", "sommer", "sourcetools", "sp", "spatial", "StanHeaders", "statsExpressions", "styler", "svglite", "sys", "testthat", "TH.data", "tibble", "tidyverse", "timechange", "timeDate", "timeSeries", "tinytex", "truncnorm", "TSP", "tzdb", "ucminf", "vcfR", "vctrs", "viridis", "viridisLite", "vroom", "waldo", "WGCNA", "whisker", "xfun", "XML", "xml2", "xts", "zip", "zoo"))
install.packages(c("afex", "AGHmatrix", "ape", "asremlPlus", "ASRgenomics", "bayestestR", "BH", "bibtex", "BiocManager", "bit", "blob", "boot", "broom", "bs4Dash", "cachem", "car", "caret", "checkmate", "chron", "class", "classInt", "cli", "clock", "CMplot", "codetools", "commonmark", "confintr", "conquer", "correlation", "curl", "dae", "datawizard", "dbplyr", "deldir", "dendextend", "DescTools", "deSolve", "distributional", "doFuture", "doRNG", "dplyr", "DT", "dtplyr", "e1071", "effectsize", "ellipse", "emmeans", "evaluate", "expm", "extrafont", "FactoMineR", "fastmatrix", "fBasics", "flextable", "fontawesome", "forcats", "foreign", "formatR", "Formula", "fs", "future", "future.apply", "gargle", "gdata", "gdtools", "gert", "ggeffects", "ggfortify", "ggiraph", "ggplot2", "ggpp", "ggpubr", "ggrepel", "ggsci", "ggside", "ggstatsplot", "gh", "globals", "gmp", "goeveg", "golem", "googledrive", "googlesheets4", "gower", "GROAN", "gss", "gtable", "gtools", "hardhat", "haven", "heatmaply", "Hmisc", "hms", "htmltools", "htmlwidgets", "httpuv", "httr", "igraph", "insight", "interp", "inti", "ipred", "jpeg", "KernSmooth", "klaR", "knitr", "labelled", "later", "lattice", "lava", "listenv", "lme4", "locfit", "loo", "lpSolve", "lubridate", "magick", "mappoly", "maptools", "markdown", "MASS", "Matrix", "matrixStats", "mc2d", "memuse", "metan", "mgcv", "modelr", "monomvn", "multcomp", "multcompView", "ncvreg", "nleqslv", "nlme", "nnet", "officer", "openssl", "ordinal", "packrat", "parallelly", "parameters", "pbapply", "pbkrtest", "performance", "pillar", "pkgbuild", "pkgdown", "pkgload", "plot3Drgl", "pls", "png", "polymapR", "posterior", "predict3d", "pROC", "processx", "prodlim", "profvis", "progressr", "pryr", "ps", "psych", "QBMS", "quantreg", "questionr", "ragg", "ranger", "rbibutils", "rcompanion", "RcppArmadillo", "RcppParallel", "RcppTOML", "RCurl", "readr", "readxl", "recipes", "reticulate", "rgl", "rlang", "rmarkdown", "Rmpfr", "roxygen2", "rrBLUP", "rsconnect", "RSQLite", "rstan", "rstantools", "rstatix", "Rttf2pt1", "rvg", "sass", "scam", "scattermore", "scatterplot3d", "seriation", "shiny", "shinyWidgets", "sjPlot", "sommer", "sourcetools", "sp", "spatial", "StanHeaders", "statsExpressions", "styler", "svglite", "sys", "testthat", "TH.data", "tibble", "tidyverse", "timechange", "timeDate", "timeSeries", "tinytex", "truncnorm", "TSP", "tzdb", "ucminf", "vcfR", "vctrs", "viridis", "viridisLite", "vroom", "waldo", "WGCNA", "whisker", "xfun", "XML", "xml2", "xts", "zip", "zoo"))
install.packages(c("afex", "AGHmatrix", "ape", "asremlPlus", "ASRgenomics", "bayestestR", "BH", "bibtex", "BiocManager", "bit", "blob", "boot", "broom", "bs4Dash", "cachem", "car", "caret", "checkmate", "chron", "class", "classInt", "cli", "clock", "CMplot", "codetools", "commonmark", "confintr", "conquer", "correlation", "curl", "dae", "datawizard", "dbplyr", "deldir", "dendextend", "DescTools", "deSolve", "distributional", "doFuture", "doRNG", "dplyr", "DT", "dtplyr", "e1071", "effectsize", "ellipse", "emmeans", "evaluate", "expm", "extrafont", "FactoMineR", "fastmatrix", "fBasics", "flextable", "fontawesome", "forcats", "foreign", "formatR", "Formula", "fs", "future", "future.apply", "gargle", "gdata", "gdtools", "gert", "ggeffects", "ggfortify", "ggiraph", "ggplot2", "ggpp", "ggpubr", "ggrepel", "ggsci", "ggside", "ggstatsplot", "gh", "globals", "gmp", "goeveg", "golem", "googledrive", "googlesheets4", "gower", "GROAN", "gss", "gtable", "gtools", "hardhat", "haven", "heatmaply", "Hmisc", "hms", "htmltools", "htmlwidgets", "httpuv", "httr", "igraph", "insight", "interp", "inti", "ipred", "jpeg", "KernSmooth", "klaR", "knitr", "labelled", "later", "lattice", "lava", "listenv", "lme4", "locfit", "loo", "lpSolve", "lubridate", "magick", "mappoly", "maptools", "markdown", "MASS", "Matrix", "matrixStats", "mc2d", "memuse", "metan", "mgcv", "modelr", "monomvn", "multcomp", "multcompView", "ncvreg", "nleqslv", "nlme", "nnet", "officer", "openssl", "ordinal", "packrat", "parallelly", "parameters", "pbapply", "pbkrtest", "performance", "pillar", "pkgbuild", "pkgdown", "pkgload", "plot3Drgl", "pls", "png", "polymapR", "posterior", "predict3d", "pROC", "processx", "prodlim", "profvis", "progressr", "pryr", "ps", "psych", "QBMS", "quantreg", "questionr", "ragg", "ranger", "rbibutils", "rcompanion", "RcppArmadillo", "RcppParallel", "RcppTOML", "RCurl", "readr", "readxl", "recipes", "reticulate", "rgl", "rlang", "rmarkdown", "Rmpfr", "roxygen2", "rrBLUP", "rsconnect", "RSQLite", "rstan", "rstantools", "rstatix", "Rttf2pt1", "rvg", "sass", "scam", "scattermore", "scatterplot3d", "seriation", "shiny", "shinyWidgets", "sjPlot", "sommer", "sourcetools", "sp", "spatial", "StanHeaders", "statsExpressions", "styler", "svglite", "sys", "testthat", "TH.data", "tibble", "tidyverse", "timechange", "timeDate", "timeSeries", "tinytex", "truncnorm", "TSP", "tzdb", "ucminf", "vcfR", "vctrs", "viridis", "viridisLite", "vroom", "waldo", "WGCNA", "whisker", "xfun", "XML", "xml2", "xts", "zip", "zoo"))
# install.packages("R/x86_64-pc-linux-gnu-library/3.6/asreml-4.1.0.149-Ubuntu-18-R4.0.tar.gz",repos = NULL)
rm(list = ls())
library(asreml)
install.packages("~/Downloads/asreml-4.1.0.176-macOS-10.13.2-R4.2.tar", repos = NULL, type = "source")
# install.packages("R/x86_64-pc-linux-gnu-library/3.6/asreml-4.1.0.149-Ubuntu-18-R4.0.tar.gz",repos = NULL)
rm(list = ls())
library(asreml)
asreml.license.activate()
# install.packages("R/x86_64-pc-linux-gnu-library/3.6/asreml-4.1.0.149-Ubuntu-18-R4.0.tar.gz",repos = NULL)
rm(list = ls())
# devtools::install_github("AparicioJohan/MrBeanApp")
library(MrBean)
View(ST5)
View(ST4.1)
install.packages(c("afex", "AGHmatrix"))
install.packages(c("ape", "asremlPlus", "ASRgenomics", "bayestestR", "BH", "bibtex"))
install.packages(c("BiocManager", "bit", "blob", "boot", "broom", "bs4Dash", "cachem", "car", "caret", "checkmate"))
install.packages(c("chron", "class", "classInt", "cli", "clock", "CMplot", "codetools", "commonmark", "confintr", "conquer", "correlation", "curl", "dae", "dbplyr", "deldir", "dendextend", "DescTools", "deSolve", "distributional", "doFuture", "doRNG", "dplyr", "DT", "dtplyr"))
install.packages(c("chron", "class", "classInt", "cli", "clock", "CMplot", "codetools", "commonmark", "confintr", "conquer", "correlation", "curl", "dae", "dbplyr", "deldir", "dendextend", "DescTools", "deSolve", "distributional", "doFuture", "doRNG", "dplyr", "DT", "dtplyr"))
install.packages(c("chron", "class", "classInt", "cli", "clock", "CMplot", "codetools", "commonmark", "confintr", "conquer", "correlation", "curl", "dae", "dbplyr", "deldir", "dendextend", "DescTools", "deSolve", "distributional", "doFuture", "doRNG", "dplyr", "DT", "dtplyr"))
install.packages(c("chron", "class", "classInt", "cli", "clock", "CMplot", "codetools", "commonmark", "confintr", "conquer", "correlation", "curl", "dae", "dbplyr", "deldir", "dendextend", "DescTools", "deSolve", "distributional", "doFuture", "doRNG", "dplyr", "DT", "dtplyr"))
install.packages(c("chron", "class", "classInt", "cli", "clock", "CMplot", "codetools", "commonmark", "confintr", "conquer", "correlation", "curl", "dae", "dbplyr", "deldir", "dendextend", "DescTools", "deSolve", "distributional", "doFuture", "doRNG", "dplyr", "DT", "dtplyr"))
install.packages(c("chron", "class", "classInt", "cli", "clock", "CMplot", "codetools", "commonmark", "confintr", "conquer", "correlation", "curl", "dae", "dbplyr", "deldir", "dendextend", "DescTools", "deSolve", "distributional", "doFuture", "doRNG", "dplyr", "DT", "dtplyr"))
install.packages(c("chron", "class", "classInt", "cli", "clock", "CMplot", "codetools", "commonmark", "confintr", "conquer", "correlation", "curl", "dae", "dbplyr", "deldir", "dendextend", "DescTools", "deSolve", "distributional", "doFuture", "doRNG", "dplyr", "DT", "dtplyr"))
install.packages(c("chron", "class", "classInt", "cli", "clock", "CMplot", "codetools", "commonmark", "confintr", "conquer", "correlation", "curl", "dae", "dbplyr", "deldir", "dendextend", "DescTools", "deSolve", "distributional", "doFuture", "doRNG", "dplyr", "DT", "dtplyr"))
install.packages(c("chron", "class", "classInt", "cli", "clock", "CMplot", "codetools", "commonmark", "confintr", "conquer", "correlation", "curl", "dae", "dbplyr", "deldir", "dendextend", "DescTools", "deSolve", "distributional", "doFuture", "doRNG", "dplyr", "DT", "dtplyr"))
install.packages(c("chron", "class", "classInt", "cli", "clock", "CMplot", "codetools", "commonmark", "confintr", "conquer", "correlation", "curl", "dae", "dbplyr", "deldir", "dendextend", "DescTools", "deSolve", "distributional", "doFuture", "doRNG", "dplyr", "DT", "dtplyr"))
install.packages(c("chron", "class", "classInt", "cli", "clock", "CMplot", "codetools", "commonmark", "confintr", "conquer", "correlation", "curl", "dae", "dbplyr", "deldir", "dendextend", "DescTools", "deSolve", "distributional", "doFuture", "doRNG", "dplyr", "DT", "dtplyr"))
install.packages(c("deldir", "DescTools", "e1071", "effectsize", "ellipse", "emmeans", "evaluate", "expm", "extrafont", "FactoMineR"))
install.packages(c("deldir", "DescTools", "fastmatrix", "fBasics", "flextable", "fontawesome", "forcats", "foreign", "formatR", "Formula", "fs", "future.apply", "gargle", "gdata", "gdtools", "gert", "ggeffects", "ggfortify", "ggiraph", "ggplot2", "ggpp", "ggpubr", "ggrepel", "ggsci", "ggside", "ggstatsplot", "gh", "globals", "gmp", "goeveg", "golem", "googledrive", "googlesheets4", "gower", "GROAN", "gss", "gtable", "gtools", "hardhat", "haven", "heatmaply", "Hmisc", "hms", "htmltools", "htmlwidgets", "httpuv", "httr", "igraph", "interp", "inti", "ipred", "jpeg", "KernSmooth", "klaR", "knitr", "labelled", "later", "lattice", "lava", "listenv", "lme4", "locfit", "loo", "lpSolve", "lubridate", "magick", "mappoly", "maptools", "markdown", "MASS", "Matrix", "matrixStats", "mc2d", "memuse", "metan", "mgcv", "modelr", "monomvn", "multcomp", "multcompView", "ncvreg", "nleqslv", "nlme", "nnet", "officer", "openssl", "ordinal", "packrat", "pbapply", "pbkrtest", "pkgbuild", "pkgdown", "pkgload", "plot3Drgl", "pls", "png", "polymapR", "posterior", "predict3d", "pROC", "processx", "prodlim", "profvis", "progressr", "pryr", "ps", "psych", "QBMS", "quantreg", "questionr", "ragg", "ranger", "rbibutils", "rcompanion", "RcppArmadillo", "RcppParallel", "RcppTOML", "RCurl", "readr", "readxl", "recipes", "reticulate", "rgl", "rmarkdown", "Rmpfr", "roxygen2", "rrBLUP", "rsconnect", "RSQLite", "rstan", "rstantools", "rstatix", "Rttf2pt1", "rvg", "sass", "scam", "scattermore", "scatterplot3d", "seriation", "shiny", "shinyWidgets", "sjPlot", "sommer", "sourcetools", "sp", "spatial", "StanHeaders", "statsExpressions", "styler", "svglite", "sys", "testthat", "TH.data", "tidyverse", "timechange", "timeDate", "timeSeries", "tinytex", "truncnorm", "TSP", "ucminf", "vcfR", "viridis", "viridisLite", "vroom", "waldo", "WGCNA", "whisker", "xfun", "XML", "xml2", "xts", "zip", "zoo"))
install.packages(c("deldir", "DescTools", "igraph", "Matrix", "ucminf"))
install.packages(c("deldir", "DescTools", "igraph", "Matrix", "ucminf"))
install.packages("igraph", type="binary")
install.packages("deldir")
install.packages("deldir")
install.packages("deldir")
install.packages("deldir")
install.packages("Matrix")
install.packages("Matrix")
30 * 50
install.packages("ucminf")
117+28+26+33
library(asreml)
c * 100 / b
a <- 10441
b <- 9277
c <- 7476
c * 100 / b
c * 100 / a
d <- 3701
d * 100 / b
d * 100 / a
d * 100 / c
117 + 28 + 26 + 33
# stagewise
rm(list = ls())
detach("package:base", unload = TRUE)
library(base)
install.packages(c("augmentedRCBD", "bslib", "confintr", "countrycode", "curl", "deldir", "DescTools", "golem", "igraph", "inti", "jsonlite", "maptools", "Matrix", "matrixStats", "mice", "mvtnorm", "parallelly", "parameters", "performance", "plotly", "RcppArmadillo", "reticulate", "rmarkdown", "sp", "StanHeaders", "styler", "ucminf", "usethis"))
install.packages("Matrix")
library(scrime)
list.ia <- list(2,1,3,3,3,2,2)
list.snp <- list(1,10,20,30,40,50,60)
simulacao_1 <- simulateSNPglm(n.obs = 250, n.snp = 1000,list.ia = list.ia, list.snp = list.snp, beta0 = 0, beta = c(200,200,200,900,200,200,200) , maf = c(0.1, 0.4),err.fun=rnorm,sd=5,rand=123)
genotipo_sim1 <- as.data.frame(simulacao_1$x)
fenotipo_sim1 <- simulacao_1$y
vector_SNP1 <- c(1,10,20,30,40,50,60)
#Histogram of the phenotype
hist(fenotipo_sim1, col='gray', xlab="Simulated phenotype 1", ylab="Number of bulls", main="")
#Boxplot of the Phenotype
boxplot(fenotipo_sim1, ylab="Simulated phenotype 1")
#####Filter 1#####
#Function for calculating the Spearman correlation coefficient
teste.spearman <- function(genotipo, fenotipo){
p_value <- vector()
for (i in 1:ncol(genotipo))
{
p_value[i] <- cor.test(genotipo[,i],fenotipo, method="spearm",exact=FALSE)$p.value
}
return(p_value)
}
Pvec_sim1 <- vector()
Pvec_sim1 <- teste.spearman(genotipo_sim1,fenotipo_sim1)
length(Pvec_sim1)
#Bonferroni corretion
PvecAdj_sim1 <- p.adjust(Pvec_sim1,method="bonferroni")
hist(PvecAdj_sim1)
length(PvecAdj_sim1)
names(Pvec_sim1) <- colnames(genotipo_sim1)
Pvec_sim1_sort <- Pvec_sim1[order(Pvec_sim1)]
View(Pvec_sim1_sort)
#Calculating the lowest p-value adjusted
min(PvecAdj_sim1)
#Calculating the SNP with the lowest p-value adjusted
names(genotipo_sim1)[which.min(PvecAdj_sim1)]
#Sorting increasingly SNPs by adjusted p-values
PvecAdj_sim1_sort <- PvecAdj_sim1[order(PvecAdj_sim1)]
View(PvecAdj_sim1_sort)
View(data_s_10_9_sim1)
View(data_s_0.60_sim1)
View(data_s_10_1_sim1)
#Separating the markers for interval adjusted p-value
data_s_10_9_sim1 <- as.data.frame(genotipo_sim1[,names(genotipo_sim1)[PvecAdj_sim1 < 1e-9]])
data_s_10_8_sim1 <- as.data.frame(genotipo_sim1[,names(genotipo_sim1)[PvecAdj_sim1 < 1e-8]])
data_s_10_7_sim1 <- as.data.frame(genotipo_sim1[,names(genotipo_sim1)[PvecAdj_sim1 < 1e-7]])
data_s_10_6_sim1 <- as.data.frame(genotipo_sim1[,names(genotipo_sim1)[PvecAdj_sim1 < 1e-6]])
data_s_10_5_sim1 <- as.data.frame(genotipo_sim1[,names(genotipo_sim1)[PvecAdj_sim1 < 1e-5]])
data_s_10_4_sim1 <- as.data.frame(genotipo_sim1[,names(genotipo_sim1)[PvecAdj_sim1 < 1e-4]])
data_s_10_3_sim1 <- as.data.frame(genotipo_sim1[,names(genotipo_sim1)[PvecAdj_sim1 < 1e-3]])
data_s_10_2_sim1 <- as.data.frame(genotipo_sim1[,names(genotipo_sim1)[PvecAdj_sim1 < 1e-2]])
data_s_10_1_sim1 <- as.data.frame(genotipo_sim1[,names(genotipo_sim1)[PvecAdj_sim1 < 1e-1]])
data_s_0.20_sim1 <- as.data.frame(genotipo_sim1[,names(genotipo_sim1)[PvecAdj_sim1 < 0.20]])
data_s_0.30_sim1 <- as.data.frame(genotipo_sim1[,names(genotipo_sim1)[PvecAdj_sim1 < 0.30]])
data_s_0.40_sim1 <- as.data.frame(genotipo_sim1[,names(genotipo_sim1)[PvecAdj_sim1 < 0.40]])
data_s_0.50_sim1 <- as.data.frame(genotipo_sim1[,names(genotipo_sim1)[PvecAdj_sim1 < 0.50]])
data_s_0.60_sim1 <- as.data.frame(genotipo_sim1[,names(genotipo_sim1)[PvecAdj_sim1 < 0.60]])
data_s_0.70_sim1 <- as.data.frame(genotipo_sim1[,names(genotipo_sim1)[PvecAdj_sim1 < 0.70]])
data_s_0.80_sim1 <- as.data.frame(genotipo_sim1[,names(genotipo_sim1)[PvecAdj_sim1 < 0.80]])
data_s_0.90_sim1 <- as.data.frame(genotipo_sim1[,names(genotipo_sim1)[PvecAdj_sim1 < 0.90]])
modelo_correto_sim1 <- genotipo_sim1[,vector_SNP1]
#Creating dataframes for generation of ARFF files
data_s_10_9_sim1.arff<-as.data.frame(cbind(data_s_10_9_sim1,fenotipo_sim1))
data_s_10_8_sim1.arff<-as.data.frame(cbind(data_s_10_8_sim1,fenotipo_sim1))
data_s_10_7_sim1.arff<-as.data.frame(cbind(data_s_10_7_sim1,fenotipo_sim1))
data_s_10_6_sim1.arff<-as.data.frame(cbind(data_s_10_6_sim1,fenotipo_sim1))
data_s_10_5_sim1.arff<-as.data.frame(cbind(data_s_10_5_sim1,fenotipo_sim1))
data_s_10_4_sim1.arff<-as.data.frame(cbind(data_s_10_4_sim1,fenotipo_sim1))
data_s_10_3_sim1.arff<-as.data.frame(cbind(data_s_10_3_sim1,fenotipo_sim1))
data_s_10_2_sim1.arff<-as.data.frame(cbind(data_s_10_2_sim1,fenotipo_sim1))
data_s_10_1_sim1.arff<-as.data.frame(cbind(data_s_10_1_sim1,fenotipo_sim1))
data_s_0.20_sim1.arff<-as.data.frame(cbind(data_s_0.20_sim1,fenotipo_sim1))
data_s_0.30_sim1.arff<-as.data.frame(cbind(data_s_0.30_sim1,fenotipo_sim1))
data_s_0.40_sim1.arff<-as.data.frame(cbind(data_s_0.40_sim1,fenotipo_sim1))
data_s_0.50_sim1.arff<-as.data.frame(cbind(data_s_0.50_sim1,fenotipo_sim1))
data_s_0.60_sim1.arff<-as.data.frame(cbind(data_s_0.60_sim1,fenotipo_sim1))
data_s_0.70_sim1.arff<-as.data.frame(cbind(data_s_0.70_sim1,fenotipo_sim1))
data_s_0.80_sim1.arff<-as.data.frame(cbind(data_s_0.80_sim1,fenotipo_sim1))
data_s_0.90_sim1.arff<-as.data.frame(cbind(data_s_0.90_sim1,fenotipo_sim1))
data_completos_sim1.arff<-as.data.frame(cbind(genotipo_sim1,fenotipo_sim1))
modelo_correto_sim1.arff<-as.data.frame(cbind(modelo_correto_sim1,fenotipo_sim1))
#Loading the package RWeka
library(RWeka)
data_s_0.20_sim1_without_Bonferroni
install.packages("RcppArmadillo")
install.packages("RcppArmadillo")
library(ASRgwas)
remove.packages("ASRgwas")
library(ASRtriala)
remove.packages("ASRtriala")
library(AmesHousing)
library(rsample)      # data splitting
library(randomForest) # basic implementation
library(ranger)       # a faster implementation of randomForest
library(caret)        # an aggregator package for performing many machine learning models
library(h2o)          # an extremely fast java-based platform
# stagewise
rm(list = ls())
devtools::install_github("jendelman/GWASpoly", build_vignettes=FALSE)
install.packages("devtools")
devtools::install_github("jendelman/GWASpoly", build_vignettes=FALSE)
library(GWASpoly)
rm(list = ls())
library(GWASpoly)
library(ggplot2)
install.packages(c("updog","ldsep"))
library(updog)
library(ldsep)
library(StageWise)
devtools::install_github("jendelman/StageWise", build_vignettes=FALSE)
library(data.table)
library(tidyverse)
library(asremlPlus)
library(goeveg)
library(asreml)
##############
# To annotate markers
# load gene annotation Medicago sativa Zhongmu No1
load("~/OneDrive - Washington State University (email.wsu.edu)/Sen_2020/yield_FD/RData/i_5.2.8.RData")
i_5.2.8 <- i_5.2.8 %>% dplyr::select(1,3)
library(GWASpoly)
library(tidyverse)
library(vcfR)
library(sommer)
library(ggplot2)
##############
# To annotate markers
# load gene annotation Medicago sativa Zhongmu No1
load("~/OneDrive - Washington State University (email.wsu.edu)/Sen_2020/yield_FD/RData/i_5.2.8.RData")
i_5.2.8 <- i_5.2.8 %>% dplyr::select(1,3)
head(i_5.2.8)
library(asreml)
library(asreml)
library(sommer)
install.packages("sommer")
library(sommer)
rm(list = ls())
data("DT_example")
DT <- DT_example
A <- A_example
View(A)
View(DT)
str(DT)
ans1 <- mmec(Yield~1,
random= ~ Name + Env + Env:Name + Env:Block,
rcov= ~ units, nIters=3,
data=DT, verbose = FALSE)
summary(ans1)$varcomp
data(DT_cpdata)
DT <- DT_cpdata
GT <- GT_cpdata
MP <- MP_cpdata
DT$idd <-DT$id; DT$ide <-DT$id ### look at the data
DT[1:5,1:5]
GT[1:5,1:5]
MP[1:5,1:5]
MP[1:5,1:3]
DT$idd
DT[1:5,1:5]
DT$id
DT$ide
DT[1:5,1:5]
View(DT)
DT <- DT_cpdata
dim(GT)
A <- A.mat(GT) # additive relationship matrix
D <- D.mat(GT) # dominance relationship matrix
E <- E.mat(GT) # epistatic relationship matrix
dim(A)
dim(D)
dim(E)
GT[1:5,1:5]
ans.ADE <- mmer(fixed = color~1,
random = ~ vsr(id,Gu=A) + vsr(idd,Gu=D),
rcov = ~ units,
nIters = 3,
data = DT,
verbose = FALSE)
DT$idd <-DT$id
DT$ide <-DT$id ### look at the data
ans.ADE <- mmer(fixed = color~1,
random = ~ vsr(id,Gu=A) + vsr(idd,Gu=D),
rcov = ~ units,
nIters = 3,
data = DT,
verbose = FALSE)
(summary(ans.ADE)$varcomp)
vpredict(ans.ADE, h2 ~ (V1) / ( V1+V3) ) # narrow sense
vpredict(ans.ADE, h2 ~ (V1+V2) / ( V1+V2+V3) ) # broad-sense
(summary(ans.ADE)$varcomp)
?A.mat
library(AGHmatrix)
data(snp.pine)
dim(snp.pine)
snp.pine[1:5,1:5]
?Amatrix
Amat <- Amatrix(ped.sol, ploidy=4, w = 0.1)
data(ped.sol)
data(snp.sol)
Amat <- Amatrix(ped.sol, ploidy=4, w = 0.1)
dim(Amat)
dim(ped.sol)
dim(snp.sol)
G_Dominance <- Gmatrix(snp.sol, method="Endelman", ploidy=4)
dim(G_Dominance)
snp.sol[1:5,1:5]
D[1:5,1:5]
G_Dominance[1:5,1:5]
snp.sol[1:5,1:5]
#Computing the additive relationship matrix based on VanRaden 2008
G_VanRaden <- Gmatrix(SNPmatrix=snp.sol, maf=0.05, method="VanRaden")
#Computing the additive relationship matrix based on VanRaden 2008
G_VanRaden <- Gmatrix(SNPmatrix=snp.sol, maf=0.05, method="VanRaden", ploidy=4)
D[1:5,1:5]
G_Dominance[1:5,1:5]
G_VanRaden[1:5,1:5]
?AmatrixPolycross
devtools::install_github("rramadeu/AGHmatrix")
library(AGHmatrix)
?AmatrixPolycross
devtools::install_github("prmunoz/AGHmatrix")
library(AGHmatrix)
?AmatrixPolycross
remove.packages(AGHmatrix)
library(AGHmatrix)
?AmatrixPolyCross
?AmatrixPolyCross
?Amatrix
library(AGHmatrix)
?AmatrixPolyCross
devtools::install_github("rramadeu/AGHmatrix")
library(AGHmatrix)
?AmatrixPolyCross
?Amatrix
?Amatrix
library(readxl)
library(dplyr)
library(tidyr)
setwd("~/Documents/git/Biodigestibility_Alfalfa/BLUEs_ST/")
#CP
BLUE_CP <- read_excel("BLUE_CP.xlsx")
View(BLUE_CP)
BLUE_ERD6 <- read_excel("BLUE_ERD6.xlsx")
BLUE_CP <- read_excel("BLUE_CP.xlsx")
BLUE_DM <- read_excel("BLUE_DM.xlsx")
BLUE_Ash <- read_excel("BLUE_Ash.xlsx")
BLUE_aNDForm <- read_excel("BLUE_aNDForm.xlsx")
BLUE_ADICP <- read_excel("BLUE_ADICP.xlsx")
BLUE_NDICP <- read_excel("BLUE_NDICP.xlsx")
BLUE_SP <- read_excel("BLUE_SP.xlsx")
BLUE_A2 <- read_excel("BLUE_A2.xlsx")
BLUE_B1 <- read_excel("BLUE_B1.xlsx")
BLUE_B2 <- read_excel("BLUE_B2.xlsx")
BLUE_C <- read_excel("BLUE_C.xlsx")
BLUE_A <- read_excel("BLUE_A.xlsx")
BLUE_B <- read_excel("BLUE_B.xlsx")
BLUE_kd <- read_excel("BLUE_kd.xlsx")
BLUE_ERD6 <- read_excel("BLUE_ERD6.xlsx")
head(BLUE_ERD6)
colnames(BLUE_ERD6)
a1 <- BLUE_ERD6
a2 <- a1 %>% dplyr::select(2,3,4)
View(a2)
a2 <- a1 %>% dplyr::select(2,3,4)
a3 <- a1 %>% dplyr::select(2,5,6)
a4 <- a1 %>% dplyr::select(2,7,8)
a5 <- a1 %>% dplyr::select(2,9,10)
a6 <- a1 %>% dplyr::select(2,11,12)
View(a2)
View(a3)
View(a4)
View(a5)
a2$env <- "ID_2020"
a3$env <- "OR_2020"
a4$env <- "OR_2021"
a5$env <- "WA_2020"
a6$env <- "WA_2021"
colnames(a2)
colnames(a2) <- c("gen", "BLUE", "weight", "env")
colnames(a3) <- c("gen", "BLUE", "weight", "env")
colnames(a4) <- c("gen", "BLUE", "weight", "env")
colnames(a5) <- c("gen", "BLUE", "weight", "env")
colnames(a6) <- c("gen", "BLUE", "weight", "env")
View(a6)
a7 <- rbind(a2,a3,a4,a5,a6)
View(a7)
View(BLUE_Ash)
View(BLUE_DM)
list1 <- list(BLUE_A, BLUE_A2, BLUE_ADICP, BLUE_aNDForm, BLUE_Ash, BLUE_B, BLUE_B1, BLUE_B2, BLUE_C, BLUE_CP, BLUE_CP, BLUE_ERD6, BLUE_kd, BLUE_NDICP, BLUE_SP)
View(list1)
names1 <- c("A","A2","ADICP","aNDForm","Ash","B","B1","B2","C","CP","ER6","kd","NDICP","SP")
names(list1) <- names1
list1 <- list(BLUE_A, BLUE_A2, BLUE_ADICP, BLUE_aNDForm, BLUE_Ash, BLUE_B, BLUE_B1, BLUE_B2, BLUE_C, BLUE_CP, BLUE_ERD6, BLUE_kd, BLUE_NDICP, BLUE_SP)
names1 <- c("A","A2","ADICP","aNDForm","Ash","B","B1","B2","C","CP","ER6","kd","NDICP","SP")
names(list1) <- names1
View(list1)
View(list1[["A"]])
View(BLUE_A)
1:length(list1)
list2 <- list()
names(list1)
list2 <- list()
for (i in 1:length(list1)) {
a1 <- list1[[i]]
a2 <- a1 %>% dplyr::select(2,3,4) # ID_2020
a3 <- a1 %>% dplyr::select(2,5,6) # OR_2020
a4 <- a1 %>% dplyr::select(2,7,8) # OR_2021
a5 <- a1 %>% dplyr::select(2,9,10) # WA_2020
a6 <- a1 %>% dplyr::select(2,11,12) # WA_2021
a2$env <- "ID_2020"
a3$env <- "OR_2020"
a4$env <- "OR_2021"
a5$env <- "WA_2020"
a6$env <- "WA_2021"
colnames(a2) <- c("gen", "BLUE", "weight", "env")
colnames(a3) <- c("gen", "BLUE", "weight", "env")
colnames(a4) <- c("gen", "BLUE", "weight", "env")
colnames(a5) <- c("gen", "BLUE", "weight", "env")
colnames(a6) <- c("gen", "BLUE", "weight", "env")
a7 <- rbind(a2,a3,a4,a5,a6)
list2[[length(list2) + 1]] <- a7
}
View(list2)
View(list2[[2]])
names(list2) <- names1
View(list2)
View(list2[["A"]])
i
names1[i]
paste0(names1[i], ".csv")
names1 <- c("A","A2","ADICP","aNDForm","Ash","B","B1","B2","C","CP","ER6","kd","NDICP","SP")
names(list1) <- names1
list1 <- list(BLUE_A, BLUE_A2, BLUE_ADICP, BLUE_aNDForm, BLUE_Ash, BLUE_B, BLUE_B1, BLUE_B2, BLUE_C, BLUE_CP, BLUE_ERD6, BLUE_kd, BLUE_NDICP, BLUE_SP)
names1 <- c("A","A2","ADICP","aNDForm","Ash","B","B1","B2","C","CP","ER6","kd","NDICP","SP")
names(list1) <- names1
list2 <- list()
for (i in 1:length(list1)) {
a1 <- list1[[i]]
a2 <- a1 %>% dplyr::select(2,3,4) # ID_2020
a3 <- a1 %>% dplyr::select(2,5,6) # OR_2020
a4 <- a1 %>% dplyr::select(2,7,8) # OR_2021
a5 <- a1 %>% dplyr::select(2,9,10) # WA_2020
a6 <- a1 %>% dplyr::select(2,11,12) # WA_2021
a2$env <- "ID_2020"
a3$env <- "OR_2020"
a4$env <- "OR_2021"
a5$env <- "WA_2020"
a6$env <- "WA_2021"
colnames(a2) <- c("gen", "BLUE", "weight", "env")
colnames(a3) <- c("gen", "BLUE", "weight", "env")
colnames(a4) <- c("gen", "BLUE", "weight", "env")
colnames(a5) <- c("gen", "BLUE", "weight", "env")
colnames(a6) <- c("gen", "BLUE", "weight", "env")
a7 <- rbind(a2,a3,a4,a5,a6)
setwd("~/Documents/git/Biodigestibility_Alfalfa/BLUEs_ST1/")
write.csv(a7, paste0(names1[i], ".csv"), row.names = F, quote = F)
list2[[length(list2) + 1]] <- a7
}
names(list2) <- names1
names1
